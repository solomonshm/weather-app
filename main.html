<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- <link rel="icon" href="/docs/4.0/assets/img/favicons/favicon.ico"> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <title>HAIRWeather</title>


    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Outfit" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="css/template.css" rel="stylesheet">
  </head>
  <style>
    .invisible {display:none}
    .visible {display:block}
    #where {text-transform: capitalize}
  </style>

  <body>

    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
      <a class="navbar-brand" href="#">HAIRWeather</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarsExampleDefault">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link" href="main.html">Home <span class="sr-only">(current)</span></a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="map.html">Map</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="compare.html">Compare</a>
          </li>
      </div>
    </nav>
    
    <main role="main" class="container">
  
      
      <div class="starter-template">
        <h1>Weather Report</h1>
        <p class="lead">Enter a location below</p>
        <input placeholder="City" id='txtCity'/> <br/>
        <input placeholder="Country" id='txtCountry'/> <br/>
        <button class="btn btn-secondary"  id=ResultsBtn onclick="gotoResults();">Go to results</button>
      </div>
   
<!-- href="results.html" -->
    <!-- </main>/.container -->


    <input type='image' name="globe" src="globe.gif" alt='map' onclick="location.href = 'map.html';">
    <input type='image' name="comparison" src="comparison.png" alt='compare' onclick="location.href = 'compare.html';">


    <article class='invisible' id='WeatherResults'>
      <h4 id='where'></h4>
      <ul>
        <li id='Desc'></li>
        <li id='Temp'></li>
        <li id='Wind'></li>
      </ul>
    </article>
    

    <script>
      function gotoResults(){
        let city = document.getElementById('txtCity').value
        let country = document.getElementById('txtCountry').value
        var temp = "results.html?city="+city+"&country=" +country;

                    window.location.href = temp;

      }



      document.addEventListener('DOMContentLoaded', function() {
                          // functions that happen on load
                      
                          getLocation();
                      }, false);

      function getLocation () {
                navigator.geolocation.getCurrentPosition(getPosition);
              }

      function getPosition (position) {
                // L.marker([position.coords.latitude, position.coords.longitude]).bindPopup('<p>This is your location</p>').addTo(mymap);
              getCity(position.coords.latitude, position.coords.longitude)
              }
              var city;
              var country;

      function getCity(lat, lng) {
        var key = 'AIzaSyAYGb_StXeIrAA-juKWdqC0oKpUsBZfWus';
        var reverse_geocode_url = 'https://maps.googleapis.com/maps/api/geocode/json?latlng='+ lat+','+lng+'&key=' +key;

        $.ajax({
          url:reverse_geocode_url,
          type:"GET",
          crossDomain: true,
          success: function (res) {
            var city = res.results[0].address_components[1].long_name;
            var country = res.results[0].address_components[3].long_name;

            getVariables (city, country)
            alert("You are in " + city)
          }
        })

        function getVariables (_city, _country){
          city = _city
          country = _country 
         // temp = "http://localhost:4443/results.html?city="+city+"&country=" +country;

        //            window.location.href = temp;

        }


      }

      //         const getWeather = () => {
      //             weatherUrl = `http://api.openweathermap.org/data/2.5/weather?q=${city},${country}&APPID=48f2d5e18b0d2bc50519b58cce6409f1`
      //             fetch(weatherUrl)
      //                 .then(response => response.json())
      //                 .then(data =>{
      //                     console.log(data);
      //                     weHaveData = true
      //                     if (data.cod == '400'){
      //                         msg = 'Error, please try again'
      //                         document.getElementById('location').innerHTML = msg
      //                         console.log(data)
      //                     } else {
      //                 //         let location = `${city}, ${country}`
      //                 //         let desc = data.weather[0].description
      //                 //         let temp = data.main.temp
      //                 //         let feels = data.main.feels_like
      //                 //         let windS = data.wind.speed
      //                 //         let windD = data.wind.deg
      

      //                 // let tempMsg = `The temperature is ${(Math.round((temp - 273) * 10) / 10)}&deg; and feels like ${(Math.round((feels - 273) * 10) / 10)}&deg;`
      //                 // let windMsg = `The wind speed is ${windS} km/h & the wind temp is ${(Math.round((windD - 273) * 10) / 10)}&deg;`
            

      //                 // //NEED TO MAKE SURE THAT A LOCATION HEADER IS ADDED TO RESULTS PAGE
      //                 // document.getElementById('where').innerHTML = location
      //                 // document.getElementById('Desc').innerHTML = desc
      //                 // document.getElementById('Temp').innerHTML = tempMsg
      //                 // document.getElementById('Wind').innerHTML = windMsg

      //                 // document.getElementById('WeatherResults').setAttribute('class','visible')
      //                 loadPage(data)
      //                 console.log(data);
      //       }
            
      //   }).catch((error) => {
      //       console.error('Error:', error);
      //   })
      // }
      
      //document.querySelector('#ResultsBtn').addEventListener('click', getWeather) 


      
    </script>
    
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    
    <!-- <script src='scripts/main.js'></script>  -->
    
    <!-- <script src="../../assets/js/vendor/popper.min.js"></script>
    <script src="../../dist/js/bootstrap.min.js"></script> -->
  </body>
</html>